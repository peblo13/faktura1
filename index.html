<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fakturowanie Przyszłości | CryptoBLIK</title>
    <meta name="description" content="Nowoczesny generator faktur online z futurystycznym designem. Szybko, wygodnie, bezpiecznie.">
    <link rel="stylesheet" href="faktura-future.css">
    <style>
        body {
            margin: 0;
            min-height: 100vh;
            font-family: 'Orbitron', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(120deg, #0f2027 0%, #2c5364 40%, #00fff7 100%);
            color: #fff;
            overflow-x: hidden;
            position: relative;
        }
        .neon {
            color: #00fff7;
            text-shadow: 0 0 8px #00fff7, 0 0 16px #00fff7, 0 0 32px #00fff7;
            background: linear-gradient(90deg, #00fff7, #2c5364, #00bfff);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: neonGlow 3s ease-in-out infinite alternate;
        }
        @keyframes neonGlow {
            0% { text-shadow: 0 0 8px #00fff7, 0 0 16px #00fff7, 0 0 32px #00fff7; }
            100% { text-shadow: 0 0 12px #00bfff, 0 0 24px #00bfff, 0 0 48px #00bfff; }
        }
        .container {
            max-width: 600px;
            margin: 48px auto 48px auto;
            background: rgba(20, 30, 60, 0.55);
            border-radius: 32px;
            box-shadow: 0 8px 40px #00fff799, 0 0 24px #2c5364cc;
            padding: 48px 48px 36px 48px;
            position: relative;
            z-index: 2;
            backdrop-filter: blur(16px) saturate(160%);
            border: 2px solid rgba(0,255,247,0.25);
        }
        h1 {
            font-size: 2.5rem;
            letter-spacing: 2px;
            margin-bottom: 24px;
        }
        label {
            display: block;
            margin: 18px 0 6px 0;
            font-weight: 600;
            letter-spacing: 1px;
        }
        input, textarea {
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            border: 1.5px solid #00fff799;
            background: rgba(26,38,57,0.7);
            color: #00fff7;
            font-size: 1.08rem;
            margin-bottom: 12px;
            box-shadow: 0 0 12px #00fff733, 0 1px 8px #2c536455;
            transition: box-shadow 0.2s, border 0.2s;
            outline: none;
        }
        input:focus, textarea:focus {
            border: 1.5px solid #00fff7;
            box-shadow: 0 0 24px #00fff7, 0 0 8px #2c5364;
        }
        .btn {
            background: linear-gradient(90deg, #00fff7 0%, #2c5364 100%);
            color: #0f2027;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            padding: 14px 32px;
            font-size: 1.1rem;
            margin-top: 18px;
            cursor: pointer;
            box-shadow: 0 0 16px #00fff7, 0 0 4px #2c5364;
            transition: background 0.2s, color 0.2s, transform 0.2s;
            animation: pulse 2s infinite;
        }
        .btn:hover {
            background: linear-gradient(90deg, #2c5364 0%, #00fff7 100%);
            color: #fff;
            transform: scale(1.05);
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 16px #00fff7, 0 0 4px #2c5364; }
            50% { box-shadow: 0 0 24px #00fff7, 0 0 8px #2c5364; }
            100% { box-shadow: 0 0 16px #00fff7, 0 0 4px #2c5364; }
        }
        .invoice {
            margin-top: 40px;
            background: rgba(0,255,247,0.10);
            border: 2px solid #00fff7cc;
            border-radius: 20px;
            padding: 28px 20px;
            box-shadow: 0 0 32px #00fff744, 0 0 8px #2c5364;
            color: #fff;
            font-family: 'Share Tech Mono', monospace;
            font-size: 1.13rem;
            backdrop-filter: blur(8px) saturate(140%);
        }
        @media (max-width: 700px) {
            .container {
                max-width: 98vw;
                margin: 12vw auto 12vw auto;
                padding: 18px 4vw 18px 4vw;
            }
            h1 {
                font-size: 1.5rem;
            }
            .invoice {
                padding: 12px 2vw;
                font-size: 1rem;
            }
            input, textarea {
                font-size: 0.98rem;
                padding: 10px;
            }
        }
        .particles {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: 0;
            pointer-events: none;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
</head>
<body>
<!-- Google AdSense TOP BANNER -->
<div style="width:100%;display:flex;justify-content:center;margin:18px 0 0 0;">
  <div style="width:100%;max-width:970px;min-height:90px;display:flex;align-items:center;justify-content:center;background:rgba(0,255,247,0.08);border:2px dashed #00fff7bb;border-radius:18px;padding:12px 0;box-shadow:0 0 16px #00fff733;position:relative;">
    <!-- Wstaw swój kod AdSense poniżej -->
    <ins class="adsbygoogle"
         style="display:block;width:100%;min-height:90px;height:auto"
         data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
         data-ad-slot="1234567890"
         data-ad-format="auto"></ins>
    <span style="position:absolute;left:12px;top:8px;font-size:0.95em;color:#00fff7a0;pointer-events:none;">Miejsce na reklamę</span>
  </div>
</div>
<canvas class="particles"></canvas>
<div class="container">
    <div style="display:flex;align-items:center;gap:18px;margin-bottom:8px;">
      <img src="logofaktura.png" alt="Logo" style="height:48px;width:auto;max-width:180px;object-fit:contain;box-shadow:0 0 12px #00fff733;border-radius:10px;background:#fff2;">
    </div>
    <h1 class="neon">Fakturowanie Przyszłości</h1>
    <button id="scanQRBtn" class="btn" type="button" style="margin-bottom:18px;">Skanuj QR</button>
    <div id="qrModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(10,20,40,0.95);z-index:1000;align-items:center;justify-content:center;">
      <div style="background:#111b2a;border-radius:18px;padding:24px;max-width:90vw;max-height:90vh;box-shadow:0 0 32px #00fff7;">
        <div id="qr-reader" style="width:320px;"></div>
        <button id="closeQR" class="btn" style="margin-top:18px;">Zamknij</button>
      </div>
    </div>
    <form id="invoiceForm">
        <label for="seller">Sprzedawca</label>
        <input type="text" id="seller" name="seller" required>
        <label for="sellerNip">NIP Sprzedawcy</label>
        <input type="text" id="sellerNip" name="sellerNip" required>
        <label for="sellerAddress">Adres Sprzedawcy</label>
        <input type="text" id="sellerAddress" name="sellerAddress" required>
        <label for="buyer">Nabywca</label>
        <input type="text" id="buyer" name="buyer" required>
        <label for="buyerNip">NIP Nabywcy</label>
        <input type="text" id="buyerNip" name="buyerNip" required>
        <label for="buyerAddress">Adres Nabywcy</label>
        <input type="text" id="buyerAddress" name="buyerAddress" required>
        <label for="item">Nazwa towaru/usługi</label>
        <input type="text" id="item" name="item" required>
        <label for="amount">Kwota netto (PLN)</label>
        <input type="number" id="amount" name="amount" step="0.01" required>
        <label for="vatRate">Stawka VAT (%)</label>
        <input type="number" id="vatRate" name="vatRate" value="23" step="0.01" required>
        <label for="desc">Opis (opcjonalnie)</label>
        <textarea id="desc" name="desc" rows="2"></textarea>
        <button type="submit" class="btn">Wygeneruj fakturę</button>
</form>
<!-- Google AdSense BOTTOM BANNER -->
<div style="width:100%;display:flex;justify-content:center;margin:32px 0 24px 0;">
  <div style="width:100%;max-width:970px;min-height:90px;display:flex;align-items:center;justify-content:center;background:rgba(0,255,247,0.08);border:2px dashed #00fff7bb;border-radius:18px;padding:12px 0;box-shadow:0 0 16px #00fff733;position:relative;">
    <!-- Wstaw swój kod AdSense poniżej -->
    <ins class="adsbygoogle"
         style="display:block;width:100%;min-height:90px;height:auto"
         data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
         data-ad-slot="1234567890"
         data-ad-format="auto"></ins>
    <span style="position:absolute;left:12px;top:8px;font-size:0.95em;color:#00fff7a0;pointer-events:none;">Miejsce na reklamę</span>
  </div>
</div>
<!-- ...existing code... -->
    </form>
    <div id="invoiceResult" class="invoice" style="display:none;">
        <div id="invoiceContent"></div>
        <button id="printBtn" class="btn" style="margin-top:20px;">Drukuj fakturę</button>
        <button id="pdfBtn" class="btn" style="margin-top:20px; margin-left:10px;">Eksportuj do PDF</button>
    </div>
</div>
<script>
// Futurystyczne cząsteczki tła
const canvas = document.querySelector('.particles');
const ctx = canvas.getContext('2d');
let w, h, particles;
function resize() {
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();
function randomColor() {
    const colors = ['#00fff7', '#2c5364', '#00bfff', '#00ffea', '#0f2027'];
    return colors[Math.floor(Math.random()*colors.length)];
}
function createParticles() {
    particles = [];
    for(let i=0;i<60;i++) {
        particles.push({
            x: Math.random()*w,
            y: Math.random()*h,
            r: Math.random()*2+1.5,
            dx: (Math.random()-0.5)*0.7,
            dy: (Math.random()-0.5)*0.7,
            c: randomColor()
        });
    }
}
createParticles();
function drawParticles() {
    ctx.clearRect(0,0,w,h);
    for(const p of particles) {
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.r,0,2*Math.PI);
        ctx.fillStyle = p.c;
        ctx.shadowColor = p.c;
        ctx.shadowBlur = 16;
        ctx.fill();
        ctx.shadowBlur = 0;
        p.x += p.dx;
        p.y += p.dy;
        if(p.x<0||p.x>w) p.dx*=-1;
        if(p.y<0||p.y>h) p.dy*=-1;
    }
    requestAnimationFrame(drawParticles);
}
drawParticles();
// Generator faktury
const form = document.getElementById('invoiceForm');
const result = document.getElementById('invoiceResult');
const invoiceContent = document.getElementById('invoiceContent');
form.addEventListener('submit', function(e) {
    e.preventDefault();
    const seller = form.seller.value;
    const sellerNip = form.sellerNip.value;
    const sellerAddress = form.sellerAddress.value;
    const buyer = form.buyer.value;
    const buyerNip = form.buyerNip.value;
    const buyerAddress = form.buyerAddress.value;
    const item = form.item.value;
    const amountNet = parseFloat(form.amount.value);
    const vatRate = parseFloat(form.vatRate.value) / 100;
    const vatAmount = amountNet * vatRate;
    const amountGross = amountNet + vatAmount;
    const desc = form.desc.value;
    const today = new Date().toISOString().slice(0,10);
    invoiceContent.innerHTML = `
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:18px;">
      <span style="font-size:2rem;font-weight:700;letter-spacing:2px;">Faktura VAT</span>
      <span style="font-size:1.1rem;">Data wystawienia: <b>${today}</b></span>
    </div>
    <div style="display:flex;gap:32px;flex-wrap:wrap;margin-bottom:18px;">
      <div style="flex:1;min-width:220px;">
        <b>Sprzedawca:</b><br>${seller}<br>NIP: ${sellerNip}<br>${sellerAddress}
      </div>
      <div style="flex:1;min-width:220px;">
        <b>Nabywca:</b><br>${buyer}<br>NIP: ${buyerNip}<br>${buyerAddress}
      </div>
    </div>
    <table style="width:100%;border-collapse:collapse;margin-bottom:18px;font-size:1.08rem;">
      <thead>
        <tr style="background:rgba(0,255,247,0.13);color:#00fff7;">
          <th style="padding:8px 4px;border-bottom:2px solid #00fff7;">Lp.</th>
          <th style="padding:8px 4px;border-bottom:2px solid #00fff7;">Nazwa towaru/usługi</th>
          <th style="padding:8px 4px;border-bottom:2px solid #00fff7;">Netto</th>
          <th style="padding:8px 4px;border-bottom:2px solid #00fff7;">VAT (%)</th>
          <th style="padding:8px 4px;border-bottom:2px solid #00fff7;">Kwota VAT</th>
          <th style="padding:8px 4px;border-bottom:2px solid #00fff7;">Brutto</th>
        </tr>
      </thead>
      <tbody>
        <tr style="background:rgba(44,83,100,0.13);">
          <td style="padding:8px 4px;text-align:center;">1</td>
          <td style="padding:8px 4px;">${item}${desc ? `<br><span style='font-size:0.95em;color:#00fff7a0;'>${desc}</span>` : ''}</td>
          <td style="padding:8px 4px;text-align:right;">${amountNet.toFixed(2)} PLN</td>
          <td style="padding:8px 4px;text-align:center;">${(vatRate*100).toFixed(2)}</td>
          <td style="padding:8px 4px;text-align:right;">${vatAmount.toFixed(2)} PLN</td>
          <td style="padding:8px 4px;text-align:right;">${amountGross.toFixed(2)} PLN</td>
        </tr>
      </tbody>
    </table>
    <div style="display:flex;justify-content:flex-end;margin-bottom:18px;">
      <table style="min-width:320px;font-size:1.08rem;">
        <tr><td style="padding:4px 8px;">Suma netto:</td><td style="padding:4px 8px;text-align:right;">${amountNet.toFixed(2)} PLN</td></tr>
        <tr><td style="padding:4px 8px;">Suma VAT:</td><td style="padding:4px 8px;text-align:right;">${vatAmount.toFixed(2)} PLN</td></tr>
        <tr style="font-weight:700;color:#00fff7;"><td style="padding:4px 8px;">Suma brutto:</td><td style="padding:4px 8px;text-align:right;">${amountGross.toFixed(2)} PLN</td></tr>
      </table>
    </div>
    <div style="display:flex;justify-content:space-between;margin-top:32px;">
      <div style="text-align:center;width:40%;opacity:0.7;">........................................<br>Podpis wystawcy</div>
      <div style="text-align:center;width:40%;opacity:0.7;">........................................<br>Podpis odbiorcy</div>
    </div>
    `;
    result.style.display = 'block';
});

// Funkcje dla przycisków
document.getElementById('printBtn').addEventListener('click', function() {
    window.print();
});

document.getElementById('pdfBtn').addEventListener('click', function() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({ orientation: 'p', unit: 'mm', format: 'a4' });
    const margin = 18;
    let y = margin;
    // Ramka
    doc.setDrawColor(0, 180, 180);
    doc.setLineWidth(1.1);
    doc.roundedRect(margin-8, margin-10, 186, 265, 8, 8, 'S');

    // Funkcja do ładowania logo jako base64
    function loadLogoAndExport(callback) {
      const img = new window.Image();
      img.crossOrigin = '';
      img.onload = function() {
        // Tworzymy tymczasowy canvas do konwersji na base64
        const c = document.createElement('canvas');
        c.width = 120; c.height = 40;
        const ctx = c.getContext('2d');
        ctx.clearRect(0,0,120,40);
        // Zachowaj proporcje logo
        let ratio = Math.min(120/img.width, 40/img.height);
        let w = img.width * ratio;
        let h = img.height * ratio;
        let x = (120-w)/2;
        let y0 = (40-h)/2;
        ctx.drawImage(img, x, y0, w, h);
        const dataUrl = c.toDataURL('image/png');
        callback(dataUrl);
      };
      img.onerror = function() {
        callback(null);
      };
      img.src = 'logofaktura.png';
    }

    loadLogoAndExport(function(logoDataUrl) {
      // Logo lub fallback tekstowy
      if (logoDataUrl) {
        doc.addImage(logoDataUrl, 'PNG', margin+2, y-2, 38, 14);
      } else {
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(18);
        doc.setTextColor(0, 180, 180);
        doc.text('VATfaktura.pl', margin+2, y+8);
      }
      // Tytuł faktury
      doc.setFontSize(22);
      doc.setTextColor(40,40,40);
      doc.text('FAKTURA VAT', 105, y+7, { align: 'center' });
      y += 14;
      doc.setFontSize(12);
      doc.setFont('helvetica', 'normal');
      doc.setTextColor(80,80,80);
      doc.text(`Data wystawienia: ${new Date().toISOString().slice(0,10)}`, 105, y, { align: 'center' });
      y += 12;
      // Sekcja sprzedawca/nabywca
      doc.setFont('helvetica', 'bold');
      doc.setTextColor(0, 180, 180);
      doc.text('Sprzedawca', margin, y);
      doc.text('Nabywca', 110, y);
      doc.setFont('helvetica', 'normal');
      doc.setTextColor(0,0,0);
      y += 6;
      doc.text(`${form.seller.value}`, margin, y);
      doc.text(`${form.buyer.value}`, 110, y);
      y += 6;
      doc.text(`NIP: ${form.sellerNip.value}`, margin, y);
      doc.text(`NIP: ${form.buyerNip.value}`, 110, y);
      y += 6;
      doc.text(`${form.sellerAddress.value}`, margin, y);
      doc.text(`${form.buyerAddress.value}`, 110, y);
      y += 10;
      // Tabela pozycji
      doc.setFont('helvetica', 'bold');
      doc.setFillColor(0, 180, 180, 30);
      doc.setTextColor(0, 180, 180);
      doc.rect(margin, y, 174, 10, 'F');
      doc.setDrawColor(0, 180, 180);
      doc.line(margin, y+10, margin+174, y+10);
      doc.text('Lp.', margin+2, y+7);
      doc.text('Nazwa towaru/usługi', margin+14, y+7);
      doc.text('Netto', margin+90, y+7);
      doc.text('VAT %', margin+120, y+7);
      doc.text('Kwota VAT', margin+140, y+7);
      doc.text('Brutto', margin+165, y+7);
      y += 10;
      doc.setFont('helvetica', 'normal');
      doc.setTextColor(0,0,0);
      doc.rect(margin, y, 174, 12);
      doc.line(margin, y+12, margin+174, y+12);
      doc.text('1', margin+2, y+8);
      let itemText = form.item.value;
      if(form.desc.value) itemText += ` (${form.desc.value})`;
      doc.text(itemText, margin+14, y+8);
      const amountNet = parseFloat(form.amount.value);
      const vatRate = parseFloat(form.vatRate.value) / 100;
      const vatAmount = amountNet * vatRate;
      const amountGross = amountNet + vatAmount;
      doc.text(`${amountNet.toFixed(2)} PLN`, margin+90, y+8, { align: 'right', maxWidth: 28 });
      doc.text(`${(vatRate*100).toFixed(2)}`, margin+120, y+8, { align: 'right', maxWidth: 18 });
      doc.text(`${vatAmount.toFixed(2)} PLN`, margin+140, y+8, { align: 'right', maxWidth: 24 });
      doc.text(`${amountGross.toFixed(2)} PLN`, margin+165, y+8, { align: 'right', maxWidth: 28 });
      y += 16;
      // Podsumowanie
      doc.setFont('helvetica', 'bold');
      doc.setTextColor(0, 180, 180);
      doc.text('Suma netto:', margin+110, y);
      doc.setTextColor(0,0,0);
      doc.text(`${amountNet.toFixed(2)} PLN`, margin+165, y, { align: 'right' });
      y += 7;
      doc.setFont('helvetica', 'bold');
      doc.setTextColor(0, 180, 180);
      doc.text('Suma VAT:', margin+110, y);
      doc.setTextColor(0,0,0);
      doc.text(`${vatAmount.toFixed(2)} PLN`, margin+165, y, { align: 'right' });
      y += 7;
      doc.setFont('helvetica', 'bold');
      doc.setTextColor(0, 180, 180);
      doc.text('Suma brutto:', margin+110, y);
      doc.setTextColor(0,0,0);
      doc.text(`${amountGross.toFixed(2)} PLN`, margin+165, y, { align: 'right' });
      y += 18;
      // Podpisy
      doc.setFont('helvetica', 'normal');
      doc.setTextColor(120,120,120);
      doc.text('........................................', margin+5, y);
      doc.text('........................................', margin+95, y);
      y += 6;
      doc.text('Podpis wystawcy', margin+20, y);
      doc.text('Podpis odbiorcy', margin+110, y);
      doc.save('faktura.pdf');
    });
});

// QR obsługa
const scanQRBtn = document.getElementById('scanQRBtn');
const qrModal = document.getElementById('qrModal');
const closeQR = document.getElementById('closeQR');
let html5Qr;
scanQRBtn.addEventListener('click', () => {
  qrModal.style.display = 'flex';
  if (!html5Qr) {
    html5Qr = new Html5Qrcode("qr-reader");
  }
  html5Qr.start(
    { facingMode: "environment" },
    { fps: 10, qrbox: 250 },
    qrCodeMessage => {
      // Oczekiwany format: JSON z polami formularza
      try {
        const data = JSON.parse(qrCodeMessage);
        if(data.seller) form.seller.value = data.seller;
        if(data.sellerNip) form.sellerNip.value = data.sellerNip;
        if(data.sellerAddress) form.sellerAddress.value = data.sellerAddress;
        if(data.buyer) form.buyer.value = data.buyer;
        if(data.buyerNip) form.buyerNip.value = data.buyerNip;
        if(data.buyerAddress) form.buyerAddress.value = data.buyerAddress;
        if(data.item) form.item.value = data.item;
        if(data.amount) form.amount.value = data.amount;
        if(data.vatRate) form.vatRate.value = data.vatRate;
        if(data.desc) form.desc.value = data.desc;
        alert('Dane z QR zostały wczytane!');
        html5Qr.stop();
        qrModal.style.display = 'none';
      } catch(e) {
        alert('Nieprawidłowy format QR!');
      }
    },
    errorMessage => {
      // ignoruj błędy skanowania
    }
  );
});
closeQR.addEventListener('click', () => {
  qrModal.style.display = 'none';
  if(html5Qr) html5Qr.stop();
});
</script>
</body>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</html>
